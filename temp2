#include <iostream>

using namespace std;

class node{
public:
    node* up;
    node* down;
    node* right;
    node* left;
    int used;
};

node* root;
node* eexx;

node* ch[100005];
int map[100005][100005];

int cal(node* root,int step){
    if(root == eexx){
        cout<<step<<"\n";
        return 1;
    }
    if((root->down==nullptr||root->down->used==1)&&(root->up==nullptr||root->up->used==1)&&(root->left==nullptr||root->left->used==1)&&(root->right==nullptr||root->right->used==1)){
        return 0;
    }
    if(root->up!=nullptr&&root->up->used==0){
        root->up->used = 1;
        cal(root->up,step+1);
    }
    if(root->down!=nullptr&&root->down->used==0){
        root->down->used = 1;
        cal(root->down,step+1);
    }
    if(root->left!=nullptr&&root->left->used==0){
        root->left->used = 1;
        cal(root->left,step+1);
    }
    if(root->right!=nullptr&&root->right->used==0){
        root->right->used = 1;
        cal(root->right,step+1);
    }
    return 0;
}


int main(){
    for(int i=0;i<100005;i++) ch[i] = NULL;
    
    int row,col;
    cin>>row>>col;
    for(int i=0;i<row;i++){
        for(int j=0;j<col;j++){
            cin>>map[i][j];
            node* temp;
            if(map[i][j]==1){
                temp = new node;
                temp->used = 0;
                
                if(i-1>=0 && ch[j]!=NULL){
                    temp->up = ch[j];
                    ch[j]->down = temp;
                }
                
                if(j-1>=0){
                    temp->left = ch[j-1];
                    ch[j-1]->right = temp;
                }
                
                ch[j] = temp;
            }
            else{
                ch[j] = NULL;
            }
            
            if(i==0 && j==0) root = temp;
            if(i==row && j==col){
                if(map[i][j]==1) eexx = temp;
                else eexx = NULL;
            }
        }
    }
    if(eexx==NULL){
        cout<<"0"<<"\n";
        return 0;
    }
    else{
        if(cal(root,1)==0){
            cout<<"0"<<"\n";
        }
    }
    return 0;
}
